"use strict";(self.webpackChunkbling_supervisor=self.webpackChunkbling_supervisor||[]).push([[4197],{18456:(e,a,n)=>{n.d(a,{Z:()=>p});var r=n(26769),s=n.n(r),i=n(697),t=n(20890),o=n(50533),l=n(11087),d=n(93517),c=n(80184);function u(e){let{links:a,activeLast:n=!1,...r}=e;const s=a[a.length-1].name,o=a.map((e=>(0,c.jsx)(m,{link:e},e.name))),l=a.map((e=>(0,c.jsx)("div",{children:e.name!==s?(0,c.jsx)(m,{link:e}):(0,c.jsx)(t.Z,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:s})},e.name)));return(0,c.jsx)(d.Z,{separator:(0,c.jsx)(i.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...r,children:n?o:l})}function m(e){let{link:a}=e;const{href:n,name:r,icon:s}=a;return(0,c.jsxs)(o.Z,{variant:"body2",component:l.rU,to:n||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[s&&(0,c.jsx)(i.Z,{sx:{mr:1,"& svg":{width:20,height:20}},children:s}),r]},r)}function p(e){let{links:a,action:n,heading:r,moreLink:l=[],sx:d,...m}=e;return(0,c.jsxs)(i.Z,{sx:{mb:5,...d},children:[(0,c.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(i.Z,{sx:{flexGrow:1},children:[(0,c.jsx)(t.Z,{variant:"h4",gutterBottom:!0,children:r}),(0,c.jsx)(u,{links:a,...m})]}),n&&(0,c.jsx)(i.Z,{sx:{flexShrink:0},children:n})]}),(0,c.jsx)(i.Z,{sx:{mt:2},children:s()(l)?(0,c.jsx)(o.Z,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(o.Z,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}},73024:(e,a,n)=>{n.d(a,{Z:()=>s});var r=n(72791);function s(e){const[a,n]=(0,r.useState)(e||"");return{currentTab:a,onChangeTab:(e,a)=>{n(a)},setCurrentTab:n}}},34197:(e,a,n)=>{n.r(a),n.d(a,{default:()=>H});var r=n(72791),s=n(89164),i=n(39124),t=n(43896),o=n(697),l=(n(38072),n(73024)),d=n(85703),c=n(17834),u=(n(43316),n(25212)),m=n(53026),p=n(18456),h=n(33168),x=n(61889),v=n(36314),j=n(57621),b=n(20890),Z=n(94294),g=n(81724),f=n(61134),y=n(44695),w=n(56125),_=n(19658),C=n(39709),S=n(98246),q=n(22377),k=n.n(q),P=n(2190),M=n(22175),V=n(61069),D=n(75350),I=n(80184);function R(e){let{isOpen:a,onCancel:n}=e;const s=(0,V.I0)(),{user:i,refresh:t}=(0,c.Z)(),l=(0,M.Z)(),{enqueueSnackbar:d}=(0,S.Ds)(),{t:u}=(0,h.$)(),{isLoading:p}=(0,V.v9)((e=>e.wallet)),[x,q]=(0,r.useState)(null),R=g.Ry().shape({method:g.Z_().required("Payment method is required"),montant:g.Rx().required("Amount is required"),cardNumber:g.Z_().when("method",{is:"Credit Card",then:g.Z_().matches(/^\d{16}$/,"Invalid card number").required("Card number is required")}),expiryDate:g.Z_().when("method",{is:"Credit Card",then:g.Z_().matches(/^(2[0-9])\/(0[1-9]|1[0-2])$/,"Invalid expiry date (format should be YY/MM)").required("Expiry date is required")}),cvv:g.Z_().when("method",{is:"Credit Card",then:g.Z_().matches(/^\d{3}$/,"Invalid CVV").required("CVV is required")})}),N={method:"Credit Card",montant:10,cardNumber:"",expiryDate:"",cvv:""},$=(0,f.cI)({resolver:(0,y.X)(R),defaultValues:N}),{watch:T,setError:E,reset:O,handleSubmit:A,formState:{errors:U,isSubmitting:L}}=$,H=T();(0,r.useEffect)((()=>{(e=>{const a=k().number(e);a.card?q(a.card.type):q(null)})(H.cardNumber)}),[H.cardNumber]);return(0,I.jsx)(w.Z,{in:a,children:(0,I.jsx)(P.RV,{methods:$,onSubmit:A((async e=>{if("Credit Card"===e.method)try{s((0,D.Av)());await(0,D.yV)(e);d("Payment success!"),await t(),O(N),s((0,D.Vg)())}catch(i){var a,n,r;if(console.error(i.response.data),d(null===i||void 0===i||null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail,{variant:"error"}),s((0,D.Vg)()),l.current)if(l.current)E("afterSubmit",{...i,message:null===(r=i.response.data)||void 0===r?void 0:r.detail})}else d("Very Soon!",{variant:"warning"})})),children:(0,I.jsxs)(j.Z,{sx:{p:3},children:[(0,I.jsx)(b.Z,{variant:"overline",sx:{mb:3,display:"block",color:"text.secondary"},children:u("params.deposit_account")}),!!U.afterSubmit&&(0,I.jsx)(_.Z,{severity:"error",children:U.afterSubmit.message}),(0,I.jsx)(o.Z,{sx:{padding:3,borderRadius:1},children:(0,I.jsxs)(v.Z,{spacing:3,children:[(0,I.jsxs)(v.Z,{spacing:2,direction:{xs:"column",md:"row"},children:[(0,I.jsxs)(P.Cc,{name:"method",label:u("params.payment_method"),placeholder:u("params.payment_method"),children:[(0,I.jsx)("option",{value:""}),["Moncash","Natcash","Credit Card"].map(((e,a)=>(0,I.jsx)("option",{value:e,children:e},a)))]}),(0,I.jsx)(P.au,{name:"montant",label:"Montant",placeholder:"Montant",type:"number"})]}),"Credit Card"===H.method&&(0,I.jsxs)(v.Z,{spacing:2,children:[(0,I.jsx)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,I.jsx)(P.au,{name:"cardNumber",label:"Card Number",InputProps:{endAdornment:x&&(0,I.jsx)(m.Z,{icon:"logos:".concat(x),width:24,height:24})}})}),(0,I.jsxs)(v.Z,{direction:"row",spacing:2,children:[(0,I.jsx)(P.au,{name:"expiryDate",label:"Expiry Date (YY/MM)"}),(0,I.jsx)(P.au,{name:"cvv",label:"CVV",type:"text"})]})]}),(0,I.jsxs)(v.Z,{direction:"row",justifyContent:"flex-end",spacing:1.5,children:[(0,I.jsx)(Z.Z,{color:"inherit",variant:"outlined",onClick:n,children:u("params.cancel")}),(0,I.jsx)(C.Z,{loading:p,type:"submit",variant:"contained",children:u("params.recharge")})]})]})})]})})})}n(5977);function N(e){let{balance:a=0,transactions:n=[]}=e;const[s,i]=(0,r.useState)(!0),[t,l]=(0,r.useState)(!1),{t:d}=(0,h.$)();return(0,I.jsx)(x.ZP,{container:!0,spacing:5,children:(0,I.jsx)(x.ZP,{item:!0,xs:12,md:7,children:(0,I.jsxs)(v.Z,{spacing:2,children:[(0,I.jsxs)(j.Z,{sx:{p:3},children:[(0,I.jsx)(b.Z,{variant:"overline",sx:{mb:3,display:"block",color:"text.secondary"},children:d("params.current_balance")}),(0,I.jsxs)(b.Z,{variant:"h4",children:[a," USD"]}),(0,I.jsx)(o.Z,{sx:{mt:{xs:2,sm:0},position:{sm:"absolute"},top:{sm:24},right:{sm:24}},children:(0,I.jsx)(Z.Z,{size:"small",variant:"contained",onClick:()=>{i(!s),l(!1)},sx:{mr:1},children:d("params.deposit")})})]}),(0,I.jsx)(R,{isOpen:s,onCancel:()=>i(!1)})]})})})}var $=n(7870);var T=n(89731);function E(){const{enqueueSnackbar:e}=(0,S.Ds)(),{t:a}=(0,h.$)(),n=g.Ry().shape({oldPassword:g.Z_().required("Old Password is required"),newPassword:g.Z_().min(6,"Password must be at least 6 characters").required("New Password is required"),confirmNewPassword:g.Z_().oneOf([g.iH("newPassword"),null],"Passwords must match")}),r=(0,f.cI)({resolver:(0,y.X)(n),defaultValues:{oldPassword:"",newPassword:"",confirmNewPassword:""}}),{reset:s,handleSubmit:i,formState:{isSubmitting:t}}=r;return(0,I.jsx)(j.Z,{sx:{p:3},children:(0,I.jsx)(P.RV,{methods:r,onSubmit:i((async a=>{try{const n=await T.Z.put("/api/v1/accounts/update-password",a);s(),e(n.data)}catch(n){console.error(n),e(n.response.data,{variant:"error"})}})),children:(0,I.jsxs)(v.Z,{spacing:3,alignItems:"flex-end",children:[(0,I.jsx)(P.au,{name:"oldPassword",type:"password",label:a("params.oldpassword")}),(0,I.jsx)(P.au,{name:"newPassword",type:"password",label:a("params.newpassword")}),(0,I.jsx)(P.au,{name:"confirmNewPassword",type:"password",label:a("params.confpassword")}),(0,I.jsx)(C.Z,{type:"submit",variant:"contained",loading:t,children:a("params.save")})]})})})}var O=n(22654),A=n(98226);function U(){const{user:e,update:a}=(0,c.Z)(),n=(0,V.I0)(),{t:s}=(0,h.$)(),{countries:i,genres:t,maritals:l}=(0,V.v9)((e=>e.generale));(0,r.useEffect)((()=>{n((0,A.ox)()),n((0,A.JZ)()),n((0,A.d)())}),[n]);const{enqueueSnackbar:d}=(0,S.Ds)(),u=(0,M.Z)(),m=g.Ry().shape({phone:g.Z_().required("phone is required"),first_name:g.Z_().required("first_name is required"),last_name:g.Z_().required("last_name is required"),email:g.Z_().email("Email must be a valid email address").required("email is required"),photo:g.nK().required("photo is required"),country:g.Z_().required("country is required"),description:g.Z_().required("description is required")}),p={phone:(null===e||void 0===e?void 0:e.phone)||"",first_name:(null===e||void 0===e?void 0:e.first_name)||"",last_name:(null===e||void 0===e?void 0:e.last_name)||"",username:(null===e||void 0===e?void 0:e.username)||"",email:(null===e||void 0===e?void 0:e.email)||"",photo:(null===e||void 0===e?void 0:e.photo)||"",country:(null===e||void 0===e?void 0:e.country)||"",description:(null===e||void 0===e?void 0:e.description)||"",city:(null===e||void 0===e?void 0:e.city)||"",address:(null===e||void 0===e?void 0:e.address)||"",genre:(null===e||void 0===e?void 0:e.genre)||"",marital:(null===e||void 0===e?void 0:e.marital)||""},[Z,w]=(0,r.useState)(!1),_=(0,f.cI)({resolver:(0,y.X)(m),defaultValues:p}),{setValue:q,watch:k,setError:D,handleSubmit:R,formState:{isSubmitting:N}}=_,T=k(),E=(0,r.useCallback)((e=>{const a=e[0];a&&q("photo",Object.assign(a,{preview:URL.createObjectURL(a)})),w(!0)}),[q]);return(0,I.jsx)(P.RV,{methods:_,onSubmit:R((async e=>{try{const n=new FormData;Object.entries(T).forEach((e=>{let[a,r]=e;["photo"].includes(a)||("born_date"===a?n.append(a,(0,O.Q$)(r)):n.append(a,r))})),!0===Z&&n.append("photo",e.photo),await a(n),d("Update success!")}catch(n){console.error(n),u.current&&(D("afterSubmit",{...n,message:n.response.statusText}),n.response.data.phone&&D("phone",{...n,message:n.response.data.phone}),n.response.data.username&&D("username",{...n,message:n.response.data.username}),n.response.data.email?D("email",{...n,message:n.response.data.email}):n.response.data.non_field_errors&&D("email",{...n,message:n.response.data.non_field_errors}),n.response.data.photo&&D("photo",{...n,message:n.response.data.photo}))}})),children:(0,I.jsxs)(x.ZP,{container:!0,spacing:3,children:[(0,I.jsx)(x.ZP,{item:!0,xs:12,md:4,children:(0,I.jsx)(j.Z,{sx:{py:10,px:3,textAlign:"center"},children:(0,I.jsx)(P.sX,{name:"photo",accept:"image/*",maxSize:3145728,onDrop:E,helperText:(0,I.jsxs)(b.Z,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",(0,I.jsx)("br",{})," max size of ",(0,$.oe)(3145728)]})})})}),(0,I.jsx)(x.ZP,{item:!0,xs:12,md:8,children:(0,I.jsxs)(j.Z,{sx:{p:3},children:[(0,I.jsxs)(o.Z,{sx:{display:"grid",rowGap:3,columnGap:2,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,I.jsx)(P.au,{type:"email",name:"email",label:s("field.email")}),(0,I.jsx)(P.PC,{name:"phone",label:s("field.phone")}),(0,I.jsx)(P.au,{name:"first_name",label:s("field.first_name")}),(0,I.jsx)(P.au,{name:"last_name",label:s("field.last_name")}),(0,I.jsx)(P.T$,{name:"born_date",maxDate:new Date,label:s("field.born_date")}),(0,I.jsxs)(P.Cc,{name:"genre",label:s("field.genre"),placeholder:s("field.genre"),children:[(0,I.jsx)("option",{value:""}),null===t||void 0===t?void 0:t.map((e=>(0,I.jsx)("option",{value:e,children:s("genre.".concat(e))},e)))]}),(0,I.jsxs)(P.Cc,{name:"marital",label:s("field.marital"),placeholder:s("field.marital"),children:[(0,I.jsx)("option",{value:""}),null===l||void 0===l?void 0:l.map((e=>(0,I.jsx)("option",{value:e,children:s("marital.".concat(e))},e)))]}),(0,I.jsxs)(P.Cc,{name:"country",label:s("field.country"),placeholder:s("field.country"),children:[(0,I.jsx)("option",{value:""}),null===i||void 0===i?void 0:i.map((e=>(0,I.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,I.jsx)(P.au,{name:"city",label:s("field.city")})]}),(0,I.jsxs)(v.Z,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:[(0,I.jsx)(P.au,{name:"description",multiline:!0,rows:4,label:"Description"}),(0,I.jsx)(C.Z,{type:"submit",variant:"contained",loading:N,children:s("params.save_change")})]})]})})]})})}n(78029),n(23197);m.Z,m.Z,m.Z,m.Z;var L=n(57689);function H(){(0,V.I0)();const e=(0,L.TH)(),a=new URLSearchParams(e.search).get("menu"),{t:n}=(0,h.$)(),{user:r,refresh:x}=(0,c.Z)(),{themeStretch:v}=(0,d.Z)(),{currentTab:j,onChangeTab:b}=(0,l.Z)(a||"profile"),Z=[{value:"profile",icon:(0,I.jsx)(m.Z,{icon:"mdi:user-edit",width:20,height:20}),component:(0,I.jsx)(U,{})},{value:"deposit",icon:(0,I.jsx)(m.Z,{icon:"solar:card-bold-duotone",width:20,height:20}),component:(0,I.jsx)(N,{balance:null===r||void 0===r?void 0:r.balance})},{value:"change_password",icon:(0,I.jsx)(m.Z,{icon:"ic:round-vpn-key",width:20,height:20}),component:(0,I.jsx)(E,{})}];return(0,I.jsx)(u.Z,{title:"User: Account Settings",children:(0,I.jsxs)(s.Z,{maxWidth:!v&&"lg",children:[(0,I.jsx)(p.Z,{heading:n("params.account"),links:[{name:n("params.account_setting")}]}),(0,I.jsx)(i.Z,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:j,onChange:b,children:Z.map((e=>(0,I.jsx)(t.Z,{disableRipple:!0,label:n("params."+e.value),icon:e.icon,value:e.value},e.value)))}),(0,I.jsx)(o.Z,{sx:{mb:5}}),Z.map((e=>e.value===j&&(0,I.jsx)(o.Z,{children:e.component},e.value)))]})})}},22654:(e,a,n)=>{n.d(a,{Mu:()=>i,Q$:()=>s,zM:()=>t});var r=n(16386);function s(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,r.Z)(new Date(e),a)}function i(e){return(0,r.Z)(new Date(e),"dd MMMM yyyy")}function t(e){return(0,r.Z)(new Date(e),"dd MMM yyyy HH:mm")}}}]);
//# sourceMappingURL=4197.6e8b2eb9.chunk.js.map