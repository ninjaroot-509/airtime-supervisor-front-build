"use strict";(self.webpackChunkbling=self.webpackChunkbling||[]).push([[637],{18456:(e,r,a)=>{a.d(r,{Z:()=>m});var n=a(26769),t=a.n(n),s=a(697),o=a(20890),i=a(50533),l=a(11087),d=a(93517),c=a(80184);function u(e){let{links:r,activeLast:a=!1,...n}=e;const t=r[r.length-1].name,i=r.map((e=>(0,c.jsx)(p,{link:e},e.name))),l=r.map((e=>(0,c.jsx)("div",{children:e.name!==t?(0,c.jsx)(p,{link:e}):(0,c.jsx)(o.Z,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:t})},e.name)));return(0,c.jsx)(d.Z,{separator:(0,c.jsx)(s.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...n,children:a?i:l})}function p(e){let{link:r}=e;const{href:a,name:n,icon:t}=r;return(0,c.jsxs)(i.Z,{variant:"body2",component:l.rU,to:a||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[t&&(0,c.jsx)(s.Z,{sx:{mr:1,"& svg":{width:20,height:20}},children:t}),n]},n)}function m(e){let{links:r,action:a,heading:n,moreLink:l=[],sx:d,...p}=e;return(0,c.jsxs)(s.Z,{sx:{mb:5,...d},children:[(0,c.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(s.Z,{sx:{flexGrow:1},children:[(0,c.jsx)(o.Z,{variant:"h4",gutterBottom:!0,children:n}),(0,c.jsx)(u,{links:r,...p})]}),a&&(0,c.jsx)(s.Z,{sx:{flexShrink:0},children:a})]}),(0,c.jsx)(s.Z,{sx:{mt:2},children:t()(l)?(0,c.jsx)(i.Z,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(i.Z,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}},637:(e,r,a)=>{a.r(r),a.d(r,{default:()=>B});var n=a(72791),t=a(35345),s=a(57689),o=a(89164),i=a(38072),l=a(61069),d=a(85703),c=a(38590),u=a(25212),p=a(18456),m=a(81724),x=a(61134),h=a(44695),f=a(39709),_=a(61889),v=a(57621),b=a(697),y=a(94721),j=a(20890),Z=a(36314),g=a(23786),w=a(94294),C=a(22654),k=a(53026),S=a(2190),q=a(98226),I=a(22175),M=a(67330),D=a(33168),P=a(80184);function R(e){let{isEdit:r,currentCustomer:a}=e;const o=(0,s.s0)(),{t:d}=(0,D.$)(),{enqueueSnackbar:u}=(0,t.Ds)(),p=m.Ry().shape({type_id:m.Z_().required(d("field.required",{obj:d("field.type_id")})),number_id:m.Z_().required(d("field.required",{obj:d("field.number_id")})),created_on:m.Z_().required(d("field.required",{obj:d("field.created_on")})),expired_on:m.Z_().required(d("field.required",{obj:d("field.expired_on")}))}),R=m.Ry().shape({first_name:m.Z_().required(d("field.required",{obj:d("field.first_name")})),last_name:m.Z_().required(d("field.required",{obj:d("field.last_name")})),country:m.Z_().required(d("field.required",{obj:d("field.country")})),city:m.Z_().required(d("field.required",{obj:d("field.city")})),address:m.Z_().required(d("field.required",{obj:d("field.address")})),born_date:m.Z_().required(d("field.required",{obj:d("field.born_date")})),genre:m.Z_().required(d("field.required",{obj:d("field.genre")})),marital:m.Z_().required(d("field.required",{obj:d("field.marital")})),user_pieces_ids:m.IX().of(p).min(1,"Must have at least one id").max(3,"That is too many id")}),B=(0,n.useMemo)((()=>{var e;return{phone:(null===a||void 0===a?void 0:a.phone)||"",first_name:(null===a||void 0===a?void 0:a.first_name)||"",last_name:(null===a||void 0===a?void 0:a.last_name)||"",photo:(null===a||void 0===a?void 0:a.photo)||null,country:(null===a||void 0===a?void 0:a.country)||"",city:(null===a||void 0===a?void 0:a.city)||"",address:(null===a||void 0===a?void 0:a.address)||"",born_date:(0,C.Q$)((null===a||void 0===a?void 0:a.born_date)||new Date),is_block:(null===a||void 0===a?void 0:a.is_block)||!1,genre:(null===a||void 0===a?void 0:a.genre)||"",marital:(null===a||void 0===a?void 0:a.marital)||"",description:(null===a||void 0===a?void 0:a.description)||"",user_pieces_ids:(null===a||void 0===a||null===(e=a.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,C.Q$)(e.created_on),expired_on:(0,C.Q$)(e.expired_on)}))))||[{type_id:"",number_id:"",created_on:new Date,expired_on:new Date}],keyId:(null===a||void 0===a?void 0:a.id)||-1}}),[a]),T=(0,x.cI)({resolver:(0,h.X)(R),defaultValues:B}),z=(0,l.I0)(),$=(0,I.Z)(),{reset:E,watch:A,control:L,setError:N,handleSubmit:Q,formState:{isSubmitting:G}}=T,H=A();(0,n.useEffect)((()=>{r&&a&&E(B),r||E(B)}),[r,a]);const{countries:O,genres:W,maritals:U,usertypeids:V}=(0,l.v9)((e=>e.generale));(0,n.useEffect)((()=>{z((0,q.JZ)()),z((0,q.d)()),z((0,q.ox)()),z((0,q.rf)())}),[z]);const{fields:X,append:J,remove:K}=(0,x.Dq)({control:L,name:"user_pieces_ids"});return(0,P.jsx)(S.RV,{methods:T,onSubmit:Q((async()=>{var e;const a={...H,born_date:(0,C.Q$)(H.born_date),user_pieces_ids:null===H||void 0===H||null===(e=H.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,C.Q$)(e.created_on),expired_on:(0,C.Q$)(e.expired_on)})))};try{if(r){const e=await(0,c.uG)(a);z((0,c.x9)(e))}else{const e=await(0,c.Sy)(a);z((0,c.Lw)(e))}E(),u(d(r?"success.UPDATED":"success.CREATE")),o(i.vB.customer.list)}catch(f){console.error(f);const e=(0,M.Z)(f);if(u(d("error.".concat(e)),{variant:"error"}),$.current){var n,t,s,l,p,m,x,h;if(null!==(n=f.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.phone)N("phone",{...f,message:null===(p=f.response)||void 0===p||null===(m=p.data)||void 0===m?void 0:m.phone});if(null!==(s=f.response)&&void 0!==s&&null!==(l=s.data)&&void 0!==l&&l.born_date)N("born_date",{...f,message:null===(x=f.response)||void 0===x||null===(h=x.data)||void 0===h?void 0:h.born_date})}}})),children:(0,P.jsx)(_.ZP,{container:!0,spacing:3,children:(0,P.jsx)(_.ZP,{item:!0,xs:12,md:8,children:(0,P.jsxs)(v.Z,{sx:{p:3},children:[(0,P.jsxs)(b.Z,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,P.jsx)(S.PC,{name:"phone",label:d("field.phone")}),(0,P.jsx)(S.au,{name:"first_name",label:d("field.first_name")}),(0,P.jsx)(S.au,{name:"last_name",label:d("field.last_name")}),(0,P.jsx)(S.T$,{name:"born_date",maxDate:new Date,label:d("field.born_date")}),(0,P.jsxs)(S.Cc,{name:"genre",label:d("field.genre"),placeholder:d("field.genre"),children:[(0,P.jsx)("option",{value:""}),null===W||void 0===W?void 0:W.map((e=>(0,P.jsx)("option",{value:e,children:d("genre.".concat(e))},e)))]}),(0,P.jsxs)(S.Cc,{name:"marital",label:d("field.marital"),placeholder:d("field.marital"),children:[(0,P.jsx)("option",{value:""}),null===U||void 0===U?void 0:U.map((e=>(0,P.jsx)("option",{value:e,children:d("marital.".concat(e))},e)))]}),(0,P.jsxs)(S.Cc,{name:"country",label:d("field.country"),placeholder:d("field.country"),children:[(0,P.jsx)("option",{value:""}),null===O||void 0===O?void 0:O.map((e=>(0,P.jsx)("option",{value:e.id,children:d("country.".concat(e.name))},e.id)))]}),(0,P.jsx)(S.au,{name:"city",label:d("field.city")}),(0,P.jsx)(S.au,{name:"address",label:d("field.address")})]}),(0,P.jsx)(y.Z,{flexItem:!0,sx:{borderStyle:"dashed",py:2}}),(0,P.jsxs)(b.Z,{sx:{py:3},children:[(0,P.jsxs)(j.Z,{variant:"h6",sx:{color:"text.secondary",mb:3},children:[d("params.line_of_id")," :"]}),(0,P.jsx)(Z.Z,{divider:(0,P.jsx)(y.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:X.map(((e,r)=>(0,P.jsxs)(Z.Z,{alignItems:"flex-start",spacing:1.5,children:[(0,P.jsxs)(Z.Z,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,P.jsx)(S.Cc,{name:"user_pieces_ids[".concat(r,"].type_id"),label:d("field.type_id"),size:"small",InputLabelProps:{shrink:!0},SelectProps:{native:!1,sx:{textTransform:"capitalize"}},children:V.map((e=>(0,P.jsx)(g.Z,{value:e,sx:{mx:1,my:.5,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:d("typeid.".concat(e))},e)))}),(0,P.jsx)(S.au,{size:"small",name:"user_pieces_ids[".concat(r,"].number_id"),label:d("field.number_id"),InputLabelProps:{shrink:!0}}),(0,P.jsx)(S.T$,{size:"small",name:"user_pieces_ids[".concat(r,"].created_on"),maxDate:new Date,label:d("field.created_on")}),(0,P.jsx)(S.T$,{size:"small",name:"user_pieces_ids[".concat(r,"].expired_on"),minDate:new Date,label:d("field.expired_on")})]}),(0,P.jsx)(w.Z,{size:"small",color:"error",startIcon:(0,P.jsx)(k.Z,{icon:"eva:trash-2-outline"}),onClick:()=>{window.confirm(d("params.deletes_alert"))&&(e=>{K(e)})(r)},children:d("params.delete")})]},e.id)))}),(0,P.jsx)(y.Z,{sx:{my:3,borderStyle:"dashed"}}),(0,P.jsx)(Z.Z,{spacing:2,direction:{xs:"column-reverse",md:"row"},alignItems:{xs:"flex-start",md:"center"},children:(0,P.jsx)(w.Z,{size:"small",startIcon:(0,P.jsx)(k.Z,{icon:"eva:plus-fill"}),onClick:()=>{J({type_id:"",number_id:"",created_on:new Date,expired_on:new Date})},sx:{flexShrink:0},children:d("params.add_new_id")})})]}),(0,P.jsx)(Z.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,P.jsx)(f.Z,{type:"submit",variant:"contained",loading:G,children:r?d("params.save_change"):d("params.create",{obj:d("p_customer.customer")})})})]})})})})}function B(){const{themeStretch:e}=(0,d.Z)(),{t:r}=(0,D.$)(),a=(0,s.s0)(),m=(0,l.I0)(),{enqueueSnackbar:x}=(0,t.Ds)(),{pathname:h}=(0,s.TH)(),{customerKey:f=""}=(0,s.UO)(),_=h.includes("edit"),[v,b]=(0,n.useState)(null);(0,n.useEffect)((()=>{_&&y()}),[f]);const y=async()=>{try{const e=await(0,c.jy)(Number(f));b(e),m((0,c.OL)())}catch(e){console.error(e);const r=(0,M.Z)(e);x(r,{variant:"error"}),a(i.vB.customer.root)}};return(0,P.jsx)(u.Z,{title:"Customer: ".concat(r(_?"p_customer.edit_customer":"p_customer.new_customer")),children:(0,P.jsxs)(o.Z,{maxWidth:!e&&"lg",children:[(0,P.jsx)(p.Z,{heading:r(_?"p_customer.edit_customer":"p_customer.new_customer"),links:[{name:r("params.dashboard"),href:i.vB.root},{name:r("sideBar.customer"),href:i.vB.customer.root},{name:_?"".concat(r("p_customer.customer")," ").concat(null===v||void 0===v?void 0:v.full_name):r("p_customer.new_customer")}]}),(0,P.jsx)(R,{isEdit:_,currentCustomer:v})]})})}},67330:(e,r,a)=>{a.d(r,{Z:()=>n});const n=e=>{var r;if(null!==(r=e.response)&&void 0!==r&&r.data){if("string"===typeof e.response.data)return e.response.data;if(Array.isArray(e.response.data))return e.response.data[0];if(e.response.data.detail)return e.response.data.detail}return"An error occurred. Please try again."}},22654:(e,r,a)=>{a.d(r,{Mu:()=>s,Q$:()=>t,zM:()=>o});var n=a(16386);function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,n.Z)(new Date(e),r)}function s(e){return(0,n.Z)(new Date(e),"dd MMMM yyyy")}function o(e){return(0,n.Z)(new Date(e),"dd MMM yyyy HH:mm")}},93517:(e,r,a)=>{a.d(r,{Z:()=>M});var n=a(87462),t=a(63366),s=a(72791),o=(a(57441),a(63733)),i=a(94419),l=a(40536),d=a(66934),c=a(31402),u=a(20890),p=a(12065),m=a(74223),x=a(80184);const h=(0,m.Z)((0,x.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");var f=a(95080);const _=["slots","slotProps"],v=(0,d.ZP)(f.Z)((e=>{let{theme:r}=e;return(0,n.Z)({display:"flex",marginLeft:"calc(".concat(r.spacing(1)," * 0.5)"),marginRight:"calc(".concat(r.spacing(1)," * 0.5)")},"light"===r.palette.mode?{backgroundColor:r.palette.grey[100],color:r.palette.grey[700]}:{backgroundColor:r.palette.grey[700],color:r.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,n.Z)({},"light"===r.palette.mode?{backgroundColor:r.palette.grey[200]}:{backgroundColor:r.palette.grey[600]}),"&:active":(0,n.Z)({boxShadow:r.shadows[0]},"light"===r.palette.mode?{backgroundColor:(0,p._4)(r.palette.grey[200],.12)}:{backgroundColor:(0,p._4)(r.palette.grey[600],.12)})})})),b=(0,d.ZP)(h)({width:24,height:16});const y=function(e){const{slots:r={},slotProps:a={}}=e,s=(0,t.Z)(e,_),o=e;return(0,x.jsx)("li",{children:(0,x.jsx)(v,(0,n.Z)({focusRipple:!0},s,{ownerState:o,children:(0,x.jsx)(b,(0,n.Z)({as:r.CollapsedIcon,ownerState:o},a.collapsedIcon))}))})};var j=a(75878),Z=a(21217);function g(e){return(0,Z.Z)("MuiBreadcrumbs",e)}const w=(0,j.Z)("MuiBreadcrumbs",["root","ol","li","separator"]),C=["children","className","component","slots","slotProps","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],k=(0,d.ZP)(u.Z,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,r)=>[{["& .".concat(w.li)]:r.li},r.root]})({}),S=(0,d.ZP)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,r)=>r.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),q=(0,d.ZP)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,r)=>r.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function I(e,r,a,n){return e.reduce(((t,s,o)=>(o<e.length-1?t=t.concat(s,(0,x.jsx)(q,{"aria-hidden":!0,className:r,ownerState:n,children:a},"separator-".concat(o))):t.push(s),t)),[])}const M=s.forwardRef((function(e,r){const a=(0,c.Z)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:u,component:p="nav",slots:m={},slotProps:h={},expandText:f="Show path",itemsAfterCollapse:_=1,itemsBeforeCollapse:v=1,maxItems:b=8,separator:j="/"}=a,Z=(0,t.Z)(a,C),[w,q]=s.useState(!1),M=(0,n.Z)({},a,{component:p,expanded:w,expandText:f,itemsAfterCollapse:_,itemsBeforeCollapse:v,maxItems:b,separator:j}),D=(e=>{const{classes:r}=e;return(0,i.Z)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},g,r)})(M),P=(0,l.y)({elementType:m.CollapsedIcon,externalSlotProps:h.collapsedIcon,ownerState:M}),R=s.useRef(null),B=s.Children.toArray(d).filter((e=>s.isValidElement(e))).map(((e,r)=>(0,x.jsx)("li",{className:D.li,children:e},"child-".concat(r))));return(0,x.jsx)(k,(0,n.Z)({ref:r,component:p,color:"text.secondary",className:(0,o.Z)(D.root,u),ownerState:M},Z,{children:(0,x.jsx)(S,{className:D.ol,ref:R,ownerState:M,children:I(w||b&&B.length<=b?B:(e=>v+_>=e.length?e:[...e.slice(0,v),(0,x.jsx)(y,{"aria-label":f,slots:{CollapsedIcon:m.CollapsedIcon},slotProps:{collapsedIcon:P},onClick:()=>{q(!0);const e=R.current.querySelector("a[href],button,[tabindex]");e&&e.focus()}},"ellipsis"),...e.slice(e.length-_,e.length)])(B),D.separator,j,M)})}))}))}}]);
//# sourceMappingURL=637.e6c13a86.chunk.js.map