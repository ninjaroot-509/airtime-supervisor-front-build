"use strict";(self.webpackChunkbling_supervisor=self.webpackChunkbling_supervisor||[]).push([[637],{18456:(e,r,s)=>{s.d(r,{Z:()=>m});var a=s(26769),n=s.n(a),t=s(697),o=s(20890),i=s(50533),l=s(11087),d=s(93517),c=s(80184);function u(e){let{links:r,activeLast:s=!1,...a}=e;const n=r[r.length-1].name,i=r.map((e=>(0,c.jsx)(p,{link:e},e.name))),l=r.map((e=>(0,c.jsx)("div",{children:e.name!==n?(0,c.jsx)(p,{link:e}):(0,c.jsx)(o.Z,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:n})},e.name)));return(0,c.jsx)(d.Z,{separator:(0,c.jsx)(t.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...a,children:s?i:l})}function p(e){let{link:r}=e;const{href:s,name:a,icon:n}=r;return(0,c.jsxs)(i.Z,{variant:"body2",component:l.rU,to:s||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[n&&(0,c.jsx)(t.Z,{sx:{mr:1,"& svg":{width:20,height:20}},children:n}),a]},a)}function m(e){let{links:r,action:s,heading:a,moreLink:l=[],sx:d,...p}=e;return(0,c.jsxs)(t.Z,{sx:{mb:5,...d},children:[(0,c.jsxs)(t.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(t.Z,{sx:{flexGrow:1},children:[(0,c.jsx)(o.Z,{variant:"h4",gutterBottom:!0,children:a}),(0,c.jsx)(u,{links:r,...p})]}),s&&(0,c.jsx)(t.Z,{sx:{flexShrink:0},children:s})]}),(0,c.jsx)(t.Z,{sx:{mt:2},children:n()(l)?(0,c.jsx)(i.Z,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(i.Z,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}},637:(e,r,s)=>{s.r(r),s.d(r,{default:()=>B});var a=s(72791),n=s(35345),t=s(57689),o=s(89164),i=s(38072),l=s(61069),d=s(85703),c=s(38590),u=s(25212),p=s(18456),m=s(81724),x=s(61134),h=s(44695),f=s(39709),_=s(61889),v=s(57621),b=s(697),y=s(94721),j=s(20890),Z=s(36314),g=s(23786),w=s(94294),C=s(22654),k=s(53026),S=s(2190),q=s(98226),I=s(22175),M=s(67330),D=s(33168),P=s(80184);function R(e){let{isEdit:r,currentCustomer:s}=e;const o=(0,t.s0)(),{t:d}=(0,D.$)(),{enqueueSnackbar:u}=(0,n.Ds)(),p=m.Ry().shape({type_id:m.Z_().required(d("field.required",{obj:d("field.type_id")})),number_id:m.Z_().required(d("field.required",{obj:d("field.number_id")})),created_on:m.Z_().required(d("field.required",{obj:d("field.created_on")})),expired_on:m.Z_().required(d("field.required",{obj:d("field.expired_on")}))}),R=m.Ry().shape({first_name:m.Z_().required(d("field.required",{obj:d("field.first_name")})),last_name:m.Z_().required(d("field.required",{obj:d("field.last_name")})),country:m.Z_().required(d("field.required",{obj:d("field.country")})),city:m.Z_().required(d("field.required",{obj:d("field.city")})),address:m.Z_().required(d("field.required",{obj:d("field.address")})),born_date:m.Z_().required(d("field.required",{obj:d("field.born_date")})),genre:m.Z_().required(d("field.required",{obj:d("field.genre")})),marital:m.Z_().required(d("field.required",{obj:d("field.marital")})),user_pieces_ids:m.IX().of(p).min(1,"Must have at least one id").max(3,"That is too many id")}),B=(0,a.useMemo)((()=>{var e;return{phone:(null===s||void 0===s?void 0:s.phone)||"",first_name:(null===s||void 0===s?void 0:s.first_name)||"",last_name:(null===s||void 0===s?void 0:s.last_name)||"",photo:(null===s||void 0===s?void 0:s.photo)||null,country:(null===s||void 0===s?void 0:s.country)||"",city:(null===s||void 0===s?void 0:s.city)||"",address:(null===s||void 0===s?void 0:s.address)||"",born_date:(0,C.Q$)((null===s||void 0===s?void 0:s.born_date)||new Date),is_block:(null===s||void 0===s?void 0:s.is_block)||!1,genre:(null===s||void 0===s?void 0:s.genre)||"",marital:(null===s||void 0===s?void 0:s.marital)||"",description:(null===s||void 0===s?void 0:s.description)||"",user_pieces_ids:(null===s||void 0===s||null===(e=s.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,C.Q$)(e.created_on),expired_on:(0,C.Q$)(e.expired_on)}))))||[{type_id:"",number_id:"",created_on:new Date,expired_on:new Date}],keyId:(null===s||void 0===s?void 0:s.id)||-1}}),[s]),T=(0,x.cI)({resolver:(0,h.X)(R),defaultValues:B}),z=(0,l.I0)(),$=(0,I.Z)(),{reset:E,watch:A,control:L,setError:N,handleSubmit:Q,formState:{isSubmitting:G}}=T,H=A();(0,a.useEffect)((()=>{r&&s&&E(B),r||E(B)}),[r,s]);const{countries:O,genres:W,maritals:U,usertypeids:V}=(0,l.v9)((e=>e.generale));(0,a.useEffect)((()=>{z((0,q.JZ)()),z((0,q.d)()),z((0,q.ox)()),z((0,q.rf)())}),[z]);const{fields:X,append:J,remove:K}=(0,x.Dq)({control:L,name:"user_pieces_ids"});return(0,P.jsx)(S.RV,{methods:T,onSubmit:Q((async()=>{var e;const s={...H,born_date:(0,C.Q$)(H.born_date),user_pieces_ids:null===H||void 0===H||null===(e=H.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,C.Q$)(e.created_on),expired_on:(0,C.Q$)(e.expired_on)})))};try{if(r){const e=await(0,c.uG)(s);z((0,c.x9)(e))}else{const e=await(0,c.Sy)(s);z((0,c.Lw)(e))}E(),u(d(r?"success.UPDATED":"success.CREATE")),o(i.vB.customer.list)}catch(f){console.error(f);const e=(0,M.Z)(f);if(u(d("error.".concat(e)),{variant:"error"}),$.current){var a,n,t,l,p,m,x,h;if(null!==(a=f.response)&&void 0!==a&&null!==(n=a.data)&&void 0!==n&&n.phone)N("phone",{...f,message:null===(p=f.response)||void 0===p||null===(m=p.data)||void 0===m?void 0:m.phone});if(null!==(t=f.response)&&void 0!==t&&null!==(l=t.data)&&void 0!==l&&l.born_date)N("born_date",{...f,message:null===(x=f.response)||void 0===x||null===(h=x.data)||void 0===h?void 0:h.born_date})}}})),children:(0,P.jsx)(_.ZP,{container:!0,spacing:3,children:(0,P.jsx)(_.ZP,{item:!0,xs:12,md:8,children:(0,P.jsxs)(v.Z,{sx:{p:3},children:[(0,P.jsxs)(b.Z,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,P.jsx)(S.PC,{name:"phone",label:d("field.phone")}),(0,P.jsx)(S.au,{name:"first_name",label:d("field.first_name")}),(0,P.jsx)(S.au,{name:"last_name",label:d("field.last_name")}),(0,P.jsx)(S.T$,{name:"born_date",maxDate:new Date,label:d("field.born_date")}),(0,P.jsxs)(S.Cc,{name:"genre",label:d("field.genre"),placeholder:d("field.genre"),children:[(0,P.jsx)("option",{value:""}),null===W||void 0===W?void 0:W.map((e=>(0,P.jsx)("option",{value:e,children:d("genre.".concat(e))},e)))]}),(0,P.jsxs)(S.Cc,{name:"marital",label:d("field.marital"),placeholder:d("field.marital"),children:[(0,P.jsx)("option",{value:""}),null===U||void 0===U?void 0:U.map((e=>(0,P.jsx)("option",{value:e,children:d("marital.".concat(e))},e)))]}),(0,P.jsxs)(S.Cc,{name:"country",label:d("field.country"),placeholder:d("field.country"),children:[(0,P.jsx)("option",{value:""}),null===O||void 0===O?void 0:O.map((e=>(0,P.jsx)("option",{value:e.id,children:d("country.".concat(e.name))},e.id)))]}),(0,P.jsx)(S.au,{name:"city",label:d("field.city")}),(0,P.jsx)(S.au,{name:"address",label:d("field.address")})]}),(0,P.jsx)(y.Z,{flexItem:!0,sx:{borderStyle:"dashed",py:2}}),(0,P.jsxs)(b.Z,{sx:{py:3},children:[(0,P.jsxs)(j.Z,{variant:"h6",sx:{color:"text.secondary",mb:3},children:[d("params.line_of_id")," :"]}),(0,P.jsx)(Z.Z,{divider:(0,P.jsx)(y.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:X.map(((e,r)=>(0,P.jsxs)(Z.Z,{alignItems:"flex-start",spacing:1.5,children:[(0,P.jsxs)(Z.Z,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,P.jsx)(S.Cc,{name:"user_pieces_ids[".concat(r,"].type_id"),label:d("field.type_id"),size:"small",InputLabelProps:{shrink:!0},SelectProps:{native:!1,sx:{textTransform:"capitalize"}},children:V.map((e=>(0,P.jsx)(g.Z,{value:e,sx:{mx:1,my:.5,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:d("typeid.".concat(e))},e)))}),(0,P.jsx)(S.au,{size:"small",name:"user_pieces_ids[".concat(r,"].number_id"),label:d("field.number_id"),InputLabelProps:{shrink:!0}}),(0,P.jsx)(S.T$,{size:"small",name:"user_pieces_ids[".concat(r,"].created_on"),maxDate:new Date,label:d("field.created_on")}),(0,P.jsx)(S.T$,{size:"small",name:"user_pieces_ids[".concat(r,"].expired_on"),minDate:new Date,label:d("field.expired_on")})]}),(0,P.jsx)(w.Z,{size:"small",color:"error",startIcon:(0,P.jsx)(k.Z,{icon:"eva:trash-2-outline"}),onClick:()=>{window.confirm(d("params.deletes_alert"))&&(e=>{K(e)})(r)},children:d("params.delete")})]},e.id)))}),(0,P.jsx)(y.Z,{sx:{my:3,borderStyle:"dashed"}}),(0,P.jsx)(Z.Z,{spacing:2,direction:{xs:"column-reverse",md:"row"},alignItems:{xs:"flex-start",md:"center"},children:(0,P.jsx)(w.Z,{size:"small",startIcon:(0,P.jsx)(k.Z,{icon:"eva:plus-fill"}),onClick:()=>{J({type_id:"",number_id:"",created_on:new Date,expired_on:new Date})},sx:{flexShrink:0},children:d("params.add_new_id")})})]}),(0,P.jsx)(Z.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,P.jsx)(f.Z,{type:"submit",variant:"contained",loading:G,children:r?d("params.save_change"):d("params.create",{obj:d("p_customer.customer")})})})]})})})})}function B(){const{themeStretch:e}=(0,d.Z)(),{t:r}=(0,D.$)(),s=(0,t.s0)(),m=(0,l.I0)(),{enqueueSnackbar:x}=(0,n.Ds)(),{pathname:h}=(0,t.TH)(),{customerKey:f=""}=(0,t.UO)(),_=h.includes("edit"),[v,b]=(0,a.useState)(null);(0,a.useEffect)((()=>{_&&y()}),[f]);const y=async()=>{try{const e=await(0,c.jy)(Number(f));b(e),m((0,c.OL)())}catch(e){console.error(e);const r=(0,M.Z)(e);x(r,{variant:"error"}),s(i.vB.customer.root)}};return(0,P.jsx)(u.Z,{title:"Customer: ".concat(r(_?"p_customer.edit_customer":"p_customer.new_customer")),children:(0,P.jsxs)(o.Z,{maxWidth:!e&&"lg",children:[(0,P.jsx)(p.Z,{heading:r(_?"p_customer.edit_customer":"p_customer.new_customer"),links:[{name:r("params.dashboard"),href:i.vB.root},{name:r("sideBar.customer"),href:i.vB.customer.root},{name:_?"".concat(r("p_customer.customer")," ").concat(null===v||void 0===v?void 0:v.full_name):r("p_customer.new_customer")}]}),(0,P.jsx)(R,{isEdit:_,currentCustomer:v})]})})}},67330:(e,r,s)=>{s.d(r,{Z:()=>a});const a=e=>{var r;if(null!==(r=e.response)&&void 0!==r&&r.data){if("string"===typeof e.response.data)return e.response.data;if(Array.isArray(e.response.data))return e.response.data[0];if(e.response.data.detail)return e.response.data.detail}return"An error occurred. Please try again."}},22654:(e,r,s)=>{s.d(r,{Mu:()=>t,Q$:()=>n,zM:()=>o});var a=s(16386);function n(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,a.Z)(new Date(e),r)}function t(e){return(0,a.Z)(new Date(e),"dd MMMM yyyy")}function o(e){return(0,a.Z)(new Date(e),"dd MMM yyyy HH:mm")}},93517:(e,r,s)=>{s.d(r,{Z:()=>M});var a=s(87462),n=s(63366),t=s(72791),o=(s(57441),s(63733)),i=s(94419),l=s(40536),d=s(66934),c=s(31402),u=s(20890),p=s(12065),m=s(74223),x=s(80184);const h=(0,m.Z)((0,x.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");var f=s(95080);const _=["slots","slotProps"],v=(0,d.ZP)(f.Z)((e=>{let{theme:r}=e;return(0,a.Z)({display:"flex",marginLeft:"calc(".concat(r.spacing(1)," * 0.5)"),marginRight:"calc(".concat(r.spacing(1)," * 0.5)")},"light"===r.palette.mode?{backgroundColor:r.palette.grey[100],color:r.palette.grey[700]}:{backgroundColor:r.palette.grey[700],color:r.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,a.Z)({},"light"===r.palette.mode?{backgroundColor:r.palette.grey[200]}:{backgroundColor:r.palette.grey[600]}),"&:active":(0,a.Z)({boxShadow:r.shadows[0]},"light"===r.palette.mode?{backgroundColor:(0,p._4)(r.palette.grey[200],.12)}:{backgroundColor:(0,p._4)(r.palette.grey[600],.12)})})})),b=(0,d.ZP)(h)({width:24,height:16});const y=function(e){const{slots:r={},slotProps:s={}}=e,t=(0,n.Z)(e,_),o=e;return(0,x.jsx)("li",{children:(0,x.jsx)(v,(0,a.Z)({focusRipple:!0},t,{ownerState:o,children:(0,x.jsx)(b,(0,a.Z)({as:r.CollapsedIcon,ownerState:o},s.collapsedIcon))}))})};var j=s(75878),Z=s(21217);function g(e){return(0,Z.Z)("MuiBreadcrumbs",e)}const w=(0,j.Z)("MuiBreadcrumbs",["root","ol","li","separator"]),C=["children","className","component","slots","slotProps","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],k=(0,d.ZP)(u.Z,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,r)=>[{["& .".concat(w.li)]:r.li},r.root]})({}),S=(0,d.ZP)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,r)=>r.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),q=(0,d.ZP)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,r)=>r.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function I(e,r,s,a){return e.reduce(((n,t,o)=>(o<e.length-1?n=n.concat(t,(0,x.jsx)(q,{"aria-hidden":!0,className:r,ownerState:a,children:s},"separator-".concat(o))):n.push(t),n)),[])}const M=t.forwardRef((function(e,r){const s=(0,c.Z)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:u,component:p="nav",slots:m={},slotProps:h={},expandText:f="Show path",itemsAfterCollapse:_=1,itemsBeforeCollapse:v=1,maxItems:b=8,separator:j="/"}=s,Z=(0,n.Z)(s,C),[w,q]=t.useState(!1),M=(0,a.Z)({},s,{component:p,expanded:w,expandText:f,itemsAfterCollapse:_,itemsBeforeCollapse:v,maxItems:b,separator:j}),D=(e=>{const{classes:r}=e;return(0,i.Z)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},g,r)})(M),P=(0,l.y)({elementType:m.CollapsedIcon,externalSlotProps:h.collapsedIcon,ownerState:M}),R=t.useRef(null),B=t.Children.toArray(d).filter((e=>t.isValidElement(e))).map(((e,r)=>(0,x.jsx)("li",{className:D.li,children:e},"child-".concat(r))));return(0,x.jsx)(k,(0,a.Z)({ref:r,component:p,color:"text.secondary",className:(0,o.Z)(D.root,u),ownerState:M},Z,{children:(0,x.jsx)(S,{className:D.ol,ref:R,ownerState:M,children:I(w||b&&B.length<=b?B:(e=>v+_>=e.length?e:[...e.slice(0,v),(0,x.jsx)(y,{"aria-label":f,slots:{CollapsedIcon:m.CollapsedIcon},slotProps:{collapsedIcon:P},onClick:()=>{q(!0);const e=R.current.querySelector("a[href],button,[tabindex]");e&&e.focus()}},"ellipsis"),...e.slice(e.length-_,e.length)])(B),D.separator,j,M)})}))}))}}]);
//# sourceMappingURL=637.bed9dbb3.chunk.js.map