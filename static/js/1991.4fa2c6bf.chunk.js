"use strict";(self.webpackChunkbling_supervisor=self.webpackChunkbling_supervisor||[]).push([[1991],{1386:(e,a,n)=>{n.d(a,{R$:()=>r,ts:()=>i,uK:()=>t});var s=n(69525);function r(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,s.A)(new Date(e),a)}function i(e){return(0,s.A)(new Date(e),"dd MMMM yyyy")}function t(e){return(0,s.A)(new Date(e),"dd MMM yyyy HH:mm")}},21152:(e,a,n)=>{n.d(a,{A:()=>r});var s=n(65043);function r(e){const[a,n]=(0,s.useState)(e||"");return{currentTab:a,onChangeTab:(e,a)=>{n(a)},setCurrentTab:n}}},24753:(e,a,n)=>{n.d(a,{A:()=>p});var s=n(90620),r=n.n(s),i=n(96446),t=n(85865),o=n(88446),l=n(35475),d=n(22698),c=n(70579);function u(e){let{links:a,activeLast:n=!1,...s}=e;const r=a[a.length-1].name,o=a.map((e=>(0,c.jsx)(m,{link:e},e.name))),l=a.map((e=>(0,c.jsx)("div",{children:e.name!==r?(0,c.jsx)(m,{link:e}):(0,c.jsx)(t.A,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:r})},e.name)));return(0,c.jsx)(d.A,{separator:(0,c.jsx)(i.A,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...s,children:n?o:l})}function m(e){let{link:a}=e;const{href:n,name:s,icon:r}=a;return(0,c.jsxs)(o.A,{variant:"body2",component:l.N_,to:n||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[r&&(0,c.jsx)(i.A,{sx:{mr:1,"& svg":{width:20,height:20}},children:r}),s]},s)}function p(e){let{links:a,action:n,heading:s,moreLink:l=[],sx:d,...m}=e;return(0,c.jsxs)(i.A,{sx:{mb:5,...d},children:[(0,c.jsxs)(i.A,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(i.A,{sx:{flexGrow:1},children:[(0,c.jsx)(t.A,{variant:"h4",gutterBottom:!0,children:s}),(0,c.jsx)(u,{links:a,...m})]}),n&&(0,c.jsx)(i.A,{sx:{flexShrink:0},children:n})]}),(0,c.jsx)(i.A,{sx:{mt:2},children:r()(l)?(0,c.jsx)(o.A,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(o.A,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}},81991:(e,a,n)=>{n.r(a),n.d(a,{default:()=>L});var s=n(65043),r=n(19252),i=n(8939),t=n(24056),o=n(96446),l=(n(48407),n(21152)),d=n(11737),c=n(30342),u=(n(70140),n(19838)),m=n(20974),p=n(24753),h=n(49092),x=n(68903),v=n(88911),j=n(12110),b=n(85865),A=n(11906),g=n(73033),f=n(24858),w=n(18403),y=n(30279),S=n(14194),_=n(72812),k=n(83665),q=(n(57550),n(53335)),P=n(43409),N=n(65384),C=n(47556),D=n(70579);function M(e){let{isOpen:a,onCancel:n}=e;const s=(0,N.wA)(),{user:r,refresh:i}=(0,c.A)(),t=(0,P.A)(),{enqueueSnackbar:l}=(0,k.dh)(),{t:d}=(0,h.B)(),{isLoading:u}=(0,N.d4)((e=>e.wallet)),m=g.Ik().shape({type_depo:g.Yj().required("Type account is required"),amount:g.ai().min(10).required("Amount is required")}),p=(0,f.mN)({resolver:(0,w.t)(m),defaultValues:{type_depo:"USD",amount:5}}),{watch:x,setError:M,reset:T,handleSubmit:O,formState:{errors:Y,isSubmitting:B}}=p,R=x();return(0,D.jsx)(y.A,{in:a,children:(0,D.jsx)(q.Op,{methods:p,onSubmit:O((async e=>{try{s((0,C.vL)());const a=await(0,C.Wx)(e);if(null!==a&&void 0!==a&&a.redirect_url)return s((0,C.xv)()),void setTimeout((()=>{window.location.href=a.redirect_url}),100);s((0,C.xv)())}catch(i){var a,n,r;if(l(null===i||void 0===i||null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail,{variant:"error"}),s((0,C.xv)()),t.current)if(t.current)M("afterSubmit",{...i,message:null===(r=i.response.data)||void 0===r?void 0:r.detail})}})),children:(0,D.jsxs)(j.A,{sx:{p:3},children:[(0,D.jsx)(b.A,{variant:"overline",sx:{mb:3,display:"block",color:"text.secondary"},children:d("params.deposit_account")}),!!Y.afterSubmit&&(0,D.jsx)(S.A,{severity:"error",children:Y.afterSubmit.message}),(0,D.jsx)(o.A,{sx:{padding:3,borderRadius:1},children:(0,D.jsxs)(v.A,{spacing:3,children:[(0,D.jsxs)(v.A,{spacing:2,direction:{xs:"column",md:"row"},children:[(0,D.jsxs)(q.tX,{name:"type_depo",label:d("params.wallet"),placeholder:d("params.wallet"),children:[(0,D.jsx)("option",{value:""}),[{label:"Gourde",value:"HTG"},{label:"Dollar",value:"USD"}].map(((e,a)=>(0,D.jsx)("option",{value:e.value,children:e.label},a)))]}),(0,D.jsx)(q.o3,{name:"amount",label:`Montant ${null===R||void 0===R?void 0:R.type_depo}`,placeholder:"Montant",type:"number"})]}),(0,D.jsxs)(v.A,{direction:"row",justifyContent:"flex-end",spacing:1.5,children:[(0,D.jsx)(A.A,{color:"inherit",variant:"outlined",onClick:n,children:d("params.cancel")}),(0,D.jsx)(_.A,{loading:u,type:"submit",variant:"contained",children:d("params.recharge")})]})]})})]})})})}n(73856);function T(e){let{balance:a=0,balance_htg:n=0,transactions:r=[]}=e;const[i,t]=(0,s.useState)(!0),[l,d]=(0,s.useState)(!1),{t:c}=(0,h.B)();return(0,D.jsx)(x.Ay,{container:!0,spacing:5,children:(0,D.jsx)(x.Ay,{item:!0,xs:12,md:7,children:(0,D.jsxs)(v.A,{spacing:2,children:[(0,D.jsxs)(j.A,{sx:{p:3},children:[(0,D.jsx)(b.A,{variant:"overline",sx:{mb:3,display:"block",color:"text.secondary"},children:c("params.current_balance")}),(0,D.jsxs)(v.A,{spacing:2,direction:{xs:"column",md:"row"},children:[(0,D.jsxs)(b.A,{variant:"h4",children:[a," USD"]}),(0,D.jsxs)(b.A,{variant:"h4",children:[n," HTG"]})]}),(0,D.jsx)(o.A,{sx:{mt:{xs:2,sm:0},position:{sm:"absolute"},top:{sm:24},right:{sm:24}},children:(0,D.jsx)(A.A,{size:"small",variant:"contained",onClick:()=>{t(!i),d(!1)},sx:{mr:1},children:c("params.deposit")})})]}),(0,D.jsx)(M,{isOpen:i,onCancel:()=>t(!1)})]})})})}var O=n(73338);var Y=n(63204);function B(){const{enqueueSnackbar:e}=(0,k.dh)(),{t:a}=(0,h.B)(),n=g.Ik().shape({oldPassword:g.Yj().required("Old Password is required"),newPassword:g.Yj().min(6,"Password must be at least 6 characters").required("New Password is required"),confirmNewPassword:g.Yj().oneOf([g.KR("newPassword"),null],"Passwords must match")}),s=(0,f.mN)({resolver:(0,w.t)(n),defaultValues:{oldPassword:"",newPassword:"",confirmNewPassword:""}}),{reset:r,handleSubmit:i,formState:{isSubmitting:t}}=s;return(0,D.jsx)(j.A,{sx:{p:3},children:(0,D.jsx)(q.Op,{methods:s,onSubmit:i((async a=>{try{const n=await Y.A.put("/api/v1/accounts/update-password",a);r(),e(n.data)}catch(n){console.error(n),e(n.response.data,{variant:"error"})}})),children:(0,D.jsxs)(v.A,{spacing:3,alignItems:"flex-end",children:[(0,D.jsx)(q.o3,{name:"oldPassword",type:"password",label:a("params.oldpassword")}),(0,D.jsx)(q.o3,{name:"newPassword",type:"password",label:a("params.newpassword")}),(0,D.jsx)(q.o3,{name:"confirmNewPassword",type:"password",label:a("params.confpassword")}),(0,D.jsx)(_.A,{type:"submit",variant:"contained",loading:t,children:a("params.save")})]})})})}var R=n(1386),U=n(34866);function G(){const{user:e,update:a}=(0,c.A)(),n=(0,N.wA)(),{t:r}=(0,h.B)(),{countries:i,genres:t,maritals:l}=(0,N.d4)((e=>e.generale));(0,s.useEffect)((()=>{n((0,U.X6)()),n((0,U.HS)()),n((0,U.Gz)())}),[n]);const{enqueueSnackbar:d}=(0,k.dh)(),u=(0,P.A)(),m=g.Ik().shape({phone:g.Yj().required("phone is required"),firstName:g.Yj().required("firstName is required"),lastName:g.Yj().required("lastName is required"),email:g.Yj().email("Email must be a valid email address").required("email is required"),photo:g.gl().required("photo is required"),country:g.Yj().required("country is required"),description:g.Yj().required("description is required")}),p={phone:(null===e||void 0===e?void 0:e.phone)||"",firstName:(null===e||void 0===e?void 0:e.first_name)||"",lastName:(null===e||void 0===e?void 0:e.last_name)||"",username:(null===e||void 0===e?void 0:e.username)||"",email:(null===e||void 0===e?void 0:e.email)||"",photo:(null===e||void 0===e?void 0:e.photo)||"",country:(null===e||void 0===e?void 0:e.country)||"",description:(null===e||void 0===e?void 0:e.description)||"",city:(null===e||void 0===e?void 0:e.city)||"",address:(null===e||void 0===e?void 0:e.address)||"",genre:(null===e||void 0===e?void 0:e.genre)||"",marital:(null===e||void 0===e?void 0:e.marital)||""},[A,y]=(0,s.useState)(!1),S=(0,f.mN)({resolver:(0,w.t)(m),defaultValues:p}),{setValue:C,watch:M,setError:T,handleSubmit:Y,formState:{isSubmitting:B}}=S,G=M(),I=(0,s.useCallback)((e=>{const a=e[0];a&&C("photo",Object.assign(a,{preview:URL.createObjectURL(a)})),y(!0)}),[C]);return(0,D.jsx)(q.Op,{methods:S,onSubmit:Y((async e=>{try{const n=new FormData;Object.entries(G).forEach((e=>{let[a,s]=e;["photo"].includes(a)||("born_date"===a?n.append(a,(0,R.R$)(s)):n.append(a,s))})),!0===A&&n.append("photo",e.photo),await a(n),d("Update success!")}catch(n){console.error(n),u.current&&(T("afterSubmit",{...n,message:n.response.statusText}),n.response.data.phone&&T("phone",{...n,message:n.response.data.phone}),n.response.data.username&&T("username",{...n,message:n.response.data.username}),n.response.data.email?T("email",{...n,message:n.response.data.email}):n.response.data.non_field_errors&&T("email",{...n,message:n.response.data.non_field_errors}),n.response.data.photo&&T("photo",{...n,message:n.response.data.photo}))}})),children:(0,D.jsxs)(x.Ay,{container:!0,spacing:3,children:[(0,D.jsx)(x.Ay,{item:!0,xs:12,md:4,children:(0,D.jsx)(j.A,{sx:{py:10,px:3,textAlign:"center"},children:(0,D.jsx)(q.BF,{name:"photo",accept:"image/*",maxSize:3145728,onDrop:I,helperText:(0,D.jsxs)(b.A,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",(0,D.jsx)("br",{})," max size of ",(0,O.tm)(3145728)]})})})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,md:8,children:(0,D.jsxs)(j.A,{sx:{p:3},children:[(0,D.jsxs)(o.A,{sx:{display:"grid",rowGap:3,columnGap:2,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,D.jsx)(q.o3,{type:"email",name:"email",label:r("field.email")}),(0,D.jsx)(q.nU,{name:"phone",label:r("field.phone")}),(0,D.jsx)(q.o3,{name:"first_name",label:r("field.first_name")}),(0,D.jsx)(q.o3,{name:"last_name",label:r("field.last_name")}),(0,D.jsx)(q.zl,{name:"born_date",maxDate:new Date,label:r("field.born_date")}),(0,D.jsxs)(q.tX,{name:"genre",label:r("field.genre"),placeholder:r("field.genre"),children:[(0,D.jsx)("option",{value:""}),null===t||void 0===t?void 0:t.map((e=>(0,D.jsx)("option",{value:e,children:r(`genre.${e}`)},e)))]}),(0,D.jsxs)(q.tX,{name:"marital",label:r("field.marital"),placeholder:r("field.marital"),children:[(0,D.jsx)("option",{value:""}),null===l||void 0===l?void 0:l.map((e=>(0,D.jsx)("option",{value:e,children:r(`marital.${e}`)},e)))]}),(0,D.jsxs)(q.tX,{name:"country",label:r("field.country"),placeholder:r("field.country"),children:[(0,D.jsx)("option",{value:""}),null===i||void 0===i?void 0:i.map((e=>(0,D.jsx)("option",{value:e.id,children:r(`country.${e.name}`)},e.id)))]}),(0,D.jsx)(q.o3,{name:"city",label:r("field.city")})]}),(0,D.jsxs)(v.A,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:[(0,D.jsx)(q.o3,{name:"description",multiline:!0,rows:4,label:"Description"}),(0,D.jsx)(_.A,{type:"submit",variant:"contained",loading:B,children:r("params.save_change")})]})]})})]})})}n(61476),n(93488);m.A,m.A,m.A,m.A;var I=n(73216);function L(){(0,N.wA)();const e=(0,I.zy)(),a=new URLSearchParams(e.search).get("menu"),{t:n}=(0,h.B)(),{user:s,refresh:x}=(0,c.A)(),{themeStretch:v}=(0,d.A)(),{currentTab:j,onChangeTab:b}=(0,l.A)(a||"profile"),A=[{value:"profile",icon:(0,D.jsx)(m.A,{icon:"mdi:user-edit",width:20,height:20}),component:(0,D.jsx)(G,{})},{value:"deposit",icon:(0,D.jsx)(m.A,{icon:"solar:card-bold-duotone",width:20,height:20}),component:(0,D.jsx)(T,{balance:null===s||void 0===s?void 0:s.balance,balance_htg:null===s||void 0===s?void 0:s.balance_htg})},{value:"change_password",icon:(0,D.jsx)(m.A,{icon:"ic:round-vpn-key",width:20,height:20}),component:(0,D.jsx)(B,{})}];return(0,D.jsx)(u.A,{title:"User: Account Settings",children:(0,D.jsxs)(r.A,{maxWidth:!v&&"lg",children:[(0,D.jsx)(p.A,{heading:n("params.account"),links:[{name:n("params.account_setting")}]}),(0,D.jsx)(i.A,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:j,onChange:b,children:A.map((e=>(0,D.jsx)(t.A,{disableRipple:!0,label:n("params."+e.value),icon:e.icon,value:e.value},e.value)))}),(0,D.jsx)(o.A,{sx:{mb:5}}),A.map((e=>e.value===j&&(0,D.jsx)(o.A,{children:e.component},e.value)))]})})}}}]);
//# sourceMappingURL=1991.4fa2c6bf.chunk.js.map