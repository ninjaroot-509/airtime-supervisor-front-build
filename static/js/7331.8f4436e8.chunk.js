"use strict";(self.webpackChunkbling_supervisor=self.webpackChunkbling_supervisor||[]).push([[7331],{1386:(e,r,s)=>{s.d(r,{R$:()=>n,ts:()=>i,uK:()=>a});var t=s(69525);function n(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-dd-yyyy";return(0,t.A)(new Date(e),r)}function i(e){return(0,t.A)(new Date(e),"dd MMMM yyyy")}function a(e){return(0,t.A)(new Date(e),"dd MMM yyyy HH:mm")}},22698:(e,r,s)=>{s.d(r,{A:()=>$});var t=s(58168),n=s(98587),i=s(65043),a=(s(2086),s(69292)),o=s(98610),l=s(32463),d=s(34535),c=s(72876),u=s(85865),p=s(84794),m=s(66734),x=s(70579);const h=(0,m.A)((0,x.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");var f=s(75429);const v=["slots","slotProps"],_=(0,d.Ay)(f.A)((e=>{let{theme:r}=e;return(0,t.A)({display:"flex",marginLeft:`calc(${r.spacing(1)} * 0.5)`,marginRight:`calc(${r.spacing(1)} * 0.5)`},"light"===r.palette.mode?{backgroundColor:r.palette.grey[100],color:r.palette.grey[700]}:{backgroundColor:r.palette.grey[700],color:r.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,t.A)({},"light"===r.palette.mode?{backgroundColor:r.palette.grey[200]}:{backgroundColor:r.palette.grey[600]}),"&:active":(0,t.A)({boxShadow:r.shadows[0]},"light"===r.palette.mode?{backgroundColor:(0,p.tL)(r.palette.grey[200],.12)}:{backgroundColor:(0,p.tL)(r.palette.grey[600],.12)})})})),j=(0,d.Ay)(h)({width:24,height:16});const b=function(e){const{slots:r={},slotProps:s={}}=e,i=(0,n.A)(e,v),a=e;return(0,x.jsx)("li",{children:(0,x.jsx)(_,(0,t.A)({focusRipple:!0},i,{ownerState:a,children:(0,x.jsx)(j,(0,t.A)({as:r.CollapsedIcon,ownerState:a},s.collapsedIcon))}))})};var y=s(92532),g=s(72372);function A(e){return(0,g.Ay)("MuiBreadcrumbs",e)}const w=(0,y.A)("MuiBreadcrumbs",["root","ol","li","separator"]),k=["children","className","component","slots","slotProps","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],S=(0,d.Ay)(u.A,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,r)=>[{[`& .${w.li}`]:r.li},r.root]})({}),C=(0,d.Ay)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,r)=>r.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),q=(0,d.Ay)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,r)=>r.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function I(e,r,s,t){return e.reduce(((n,i,a)=>(a<e.length-1?n=n.concat(i,(0,x.jsx)(q,{"aria-hidden":!0,className:r,ownerState:t,children:s},`separator-${a}`)):n.push(i),n)),[])}const $=i.forwardRef((function(e,r){const s=(0,c.A)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:u,component:p="nav",slots:m={},slotProps:h={},expandText:f="Show path",itemsAfterCollapse:v=1,itemsBeforeCollapse:_=1,maxItems:j=8,separator:y="/"}=s,g=(0,n.A)(s,k),[w,q]=i.useState(!1),$=(0,t.A)({},s,{component:p,expanded:w,expandText:f,itemsAfterCollapse:v,itemsBeforeCollapse:_,maxItems:j,separator:y}),R=(e=>{const{classes:r}=e;return(0,o.A)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},A,r)})($),M=(0,l.Q)({elementType:m.CollapsedIcon,externalSlotProps:h.collapsedIcon,ownerState:$}),z=i.useRef(null),B=i.Children.toArray(d).filter((e=>i.isValidElement(e))).map(((e,r)=>(0,x.jsx)("li",{className:R.li,children:e},`child-${r}`)));return(0,x.jsx)(S,(0,t.A)({ref:r,component:p,color:"text.secondary",className:(0,a.A)(R.root,u),ownerState:$},g,{children:(0,x.jsx)(C,{className:R.ol,ref:z,ownerState:$,children:I(w||j&&B.length<=j?B:(e=>_+v>=e.length?e:[...e.slice(0,_),(0,x.jsx)(b,{"aria-label":f,slots:{CollapsedIcon:m.CollapsedIcon},slotProps:{collapsedIcon:M},onClick:()=>{q(!0);const e=z.current.querySelector("a[href],button,[tabindex]");e&&e.focus()}},"ellipsis"),...e.slice(e.length-v,e.length)])(B),R.separator,y,$)})}))}))},24753:(e,r,s)=>{s.d(r,{A:()=>m});var t=s(90620),n=s.n(t),i=s(96446),a=s(85865),o=s(88446),l=s(35475),d=s(22698),c=s(70579);function u(e){let{links:r,activeLast:s=!1,...t}=e;const n=r[r.length-1].name,o=r.map((e=>(0,c.jsx)(p,{link:e},e.name))),l=r.map((e=>(0,c.jsx)("div",{children:e.name!==n?(0,c.jsx)(p,{link:e}):(0,c.jsx)(a.A,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:n})},e.name)));return(0,c.jsx)(d.A,{separator:(0,c.jsx)(i.A,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),...t,children:s?o:l})}function p(e){let{link:r}=e;const{href:s,name:t,icon:n}=r;return(0,c.jsxs)(o.A,{variant:"body2",component:l.N_,to:s||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[n&&(0,c.jsx)(i.A,{sx:{mr:1,"& svg":{width:20,height:20}},children:n}),t]},t)}function m(e){let{links:r,action:s,heading:t,moreLink:l=[],sx:d,...p}=e;return(0,c.jsxs)(i.A,{sx:{mb:5,...d},children:[(0,c.jsxs)(i.A,{sx:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)(i.A,{sx:{flexGrow:1},children:[(0,c.jsx)(a.A,{variant:"h4",gutterBottom:!0,children:t}),(0,c.jsx)(u,{links:r,...p})]}),s&&(0,c.jsx)(i.A,{sx:{flexShrink:0},children:s})]}),(0,c.jsx)(i.A,{sx:{mt:2},children:n()(l)?(0,c.jsx)(o.A,{href:l,target:"_blank",rel:"noopener",variant:"body2",children:l}):l.map((e=>(0,c.jsx)(o.A,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}},37331:(e,r,s)=>{s.r(r),s.d(r,{default:()=>B});var t=s(65043),n=s(83665),i=s(73216),a=s(19252),o=s(48407),l=s(56056),d=s(11737),c=s(86969),u=s(19838),p=s(24753),m=s(73033),x=s(24858),h=s(18403),f=s(72812),v=s(68903),_=s(12110),j=s(96446),b=s(39336),y=s(85865),g=s(88911),A=s(32143),w=s(11906),k=s(1386),S=s(20974),C=s(53335),q=s(34866),I=s(43409),$=s(50716),R=s(49092),M=s(70579);function z(e){let{isEdit:r,currentCustomer:s}=e;const a=(0,i.Zp)(),{t:d}=(0,R.B)(),{enqueueSnackbar:u}=(0,n.dh)(),p=m.Ik().shape({type_id:m.Yj().required(d("field.required",{obj:d("field.type_id")})),number_id:m.Yj().required(d("field.required",{obj:d("field.number_id")})),created_on:m.Yj().required(d("field.required",{obj:d("field.created_on")})),expired_on:m.Yj().required(d("field.required",{obj:d("field.expired_on")}))}),z=m.Ik().shape({first_name:m.Yj().required(d("field.required",{obj:d("field.first_name")})),last_name:m.Yj().required(d("field.required",{obj:d("field.last_name")})),country:m.Yj().required(d("field.required",{obj:d("field.country")})),city:m.Yj().required(d("field.required",{obj:d("field.city")})),address:m.Yj().required(d("field.required",{obj:d("field.address")})),born_date:m.Yj().required(d("field.required",{obj:d("field.born_date")})),genre:m.Yj().required(d("field.required",{obj:d("field.genre")})),marital:m.Yj().required(d("field.required",{obj:d("field.marital")})),user_pieces_ids:m.YO().of(p).min(1,"Must have at least one id").max(3,"That is too many id")}),B=(0,t.useMemo)((()=>{var e;return{phone:(null===s||void 0===s?void 0:s.phone)||"",first_name:(null===s||void 0===s?void 0:s.first_name)||"",last_name:(null===s||void 0===s?void 0:s.last_name)||"",photo:(null===s||void 0===s?void 0:s.photo)||null,country:(null===s||void 0===s?void 0:s.country)||"",city:(null===s||void 0===s?void 0:s.city)||"",address:(null===s||void 0===s?void 0:s.address)||"",born_date:(0,k.R$)((null===s||void 0===s?void 0:s.born_date)||new Date),is_block:(null===s||void 0===s?void 0:s.is_block)||!1,genre:(null===s||void 0===s?void 0:s.genre)||"",marital:(null===s||void 0===s?void 0:s.marital)||"",description:(null===s||void 0===s?void 0:s.description)||"",user_pieces_ids:(null===s||void 0===s||null===(e=s.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,k.R$)(e.created_on),expired_on:(0,k.R$)(e.expired_on)}))))||[{type_id:"",number_id:"",created_on:new Date,expired_on:new Date}],keyId:(null===s||void 0===s?void 0:s.id)||-1}}),[s]),D=(0,x.mN)({resolver:(0,h.t)(z),defaultValues:B}),Y=(0,l.wA)(),P=(0,I.A)(),{reset:T,watch:E,control:N,setError:L,handleSubmit:G,formState:{isSubmitting:H}}=D,X=E();(0,t.useEffect)((()=>{r&&s&&T(B),r||T(B)}),[r,s]);const{countries:O,genres:W,maritals:K,usertypeids:U}=(0,l.d4)((e=>e.generale));(0,t.useEffect)((()=>{Y((0,q.HS)()),Y((0,q.Gz)()),Y((0,q.X6)()),Y((0,q.bC)())}),[Y]);const{fields:V,append:Z,remove:F}=(0,x.jz)({control:N,name:"user_pieces_ids"});return(0,M.jsx)(C.Op,{methods:D,onSubmit:G((async()=>{var e;const s={...X,born_date:(0,k.R$)(X.born_date),user_pieces_ids:null===X||void 0===X||null===(e=X.user_pieces_ids)||void 0===e?void 0:e.map((e=>({...e,created_on:(0,k.R$)(e.created_on),expired_on:(0,k.R$)(e.expired_on)})))};try{if(r){const e=await(0,c.Gk)(s);Y((0,c.Pw)(e))}else{const e=await(0,c.yw)(s);Y((0,c.F1)(e))}T(),u(d(r?"success.UPDATED":"success.CREATE")),a(o.nB.customer.list)}catch(f){console.error(f);const e=(0,$.A)(f);if(u(d(`error.${e}`),{variant:"error"}),P.current){var t,n,i,l,p,m,x,h;if(null!==(t=f.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.phone)L("phone",{...f,message:null===(p=f.response)||void 0===p||null===(m=p.data)||void 0===m?void 0:m.phone});if(null!==(i=f.response)&&void 0!==i&&null!==(l=i.data)&&void 0!==l&&l.born_date)L("born_date",{...f,message:null===(x=f.response)||void 0===x||null===(h=x.data)||void 0===h?void 0:h.born_date})}}})),children:(0,M.jsx)(v.Ay,{container:!0,spacing:3,children:(0,M.jsx)(v.Ay,{item:!0,xs:12,md:8,children:(0,M.jsxs)(_.A,{sx:{p:3},children:[(0,M.jsxs)(j.A,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,M.jsx)(C.nU,{name:"phone",label:d("field.phone")}),(0,M.jsx)(C.o3,{name:"first_name",label:d("field.first_name")}),(0,M.jsx)(C.o3,{name:"last_name",label:d("field.last_name")}),(0,M.jsx)(C.zl,{name:"born_date",maxDate:new Date,label:d("field.born_date")}),(0,M.jsxs)(C.tX,{name:"genre",label:d("field.genre"),placeholder:d("field.genre"),children:[(0,M.jsx)("option",{value:""}),null===W||void 0===W?void 0:W.map((e=>(0,M.jsx)("option",{value:e,children:d(`genre.${e}`)},e)))]}),(0,M.jsxs)(C.tX,{name:"marital",label:d("field.marital"),placeholder:d("field.marital"),children:[(0,M.jsx)("option",{value:""}),null===K||void 0===K?void 0:K.map((e=>(0,M.jsx)("option",{value:e,children:d(`marital.${e}`)},e)))]}),(0,M.jsxs)(C.tX,{name:"country",label:d("field.country"),placeholder:d("field.country"),children:[(0,M.jsx)("option",{value:""}),null===O||void 0===O?void 0:O.map((e=>(0,M.jsx)("option",{value:e.id,children:d(`country.${e.name}`)},e.id)))]}),(0,M.jsx)(C.o3,{name:"city",label:d("field.city")}),(0,M.jsx)(C.o3,{name:"address",label:d("field.address")})]}),(0,M.jsx)(b.A,{flexItem:!0,sx:{borderStyle:"dashed",py:2}}),(0,M.jsxs)(j.A,{sx:{py:3},children:[(0,M.jsxs)(y.A,{variant:"h6",sx:{color:"text.secondary",mb:3},children:[d("params.line_of_id")," :"]}),(0,M.jsx)(g.A,{divider:(0,M.jsx)(b.A,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:V.map(((e,r)=>(0,M.jsxs)(g.A,{alignItems:"flex-start",spacing:1.5,children:[(0,M.jsxs)(g.A,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[(0,M.jsx)(C.tX,{name:`user_pieces_ids[${r}].type_id`,label:d("field.type_id"),size:"small",InputLabelProps:{shrink:!0},SelectProps:{native:!1,sx:{textTransform:"capitalize"}},children:U.map((e=>(0,M.jsx)(A.A,{value:e,sx:{mx:1,my:.5,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:d(`typeid.${e}`)},e)))}),(0,M.jsx)(C.o3,{size:"small",name:`user_pieces_ids[${r}].number_id`,label:d("field.number_id"),InputLabelProps:{shrink:!0}}),(0,M.jsx)(C.zl,{size:"small",name:`user_pieces_ids[${r}].created_on`,maxDate:new Date,label:d("field.created_on")}),(0,M.jsx)(C.zl,{size:"small",name:`user_pieces_ids[${r}].expired_on`,minDate:new Date,label:d("field.expired_on")})]}),(0,M.jsx)(w.A,{size:"small",color:"error",startIcon:(0,M.jsx)(S.A,{icon:"eva:trash-2-outline"}),onClick:()=>{window.confirm(d("params.deletes_alert"))&&(e=>{F(e)})(r)},children:d("params.delete")})]},e.id)))}),(0,M.jsx)(b.A,{sx:{my:3,borderStyle:"dashed"}}),(0,M.jsx)(g.A,{spacing:2,direction:{xs:"column-reverse",md:"row"},alignItems:{xs:"flex-start",md:"center"},children:(0,M.jsx)(w.A,{size:"small",startIcon:(0,M.jsx)(S.A,{icon:"eva:plus-fill"}),onClick:()=>{Z({type_id:"",number_id:"",created_on:new Date,expired_on:new Date})},sx:{flexShrink:0},children:d("params.add_new_id")})})]}),(0,M.jsx)(g.A,{alignItems:"flex-end",sx:{mt:3},children:(0,M.jsx)(f.A,{type:"submit",variant:"contained",loading:H,children:r?d("params.save_change"):d("params.create",{obj:d("p_customer.customer")})})})]})})})})}function B(){const{themeStretch:e}=(0,d.A)(),{t:r}=(0,R.B)(),s=(0,i.Zp)(),m=(0,l.wA)(),{enqueueSnackbar:x}=(0,n.dh)(),{pathname:h}=(0,i.zy)(),{customerKey:f=""}=(0,i.g)(),v=h.includes("edit"),[_,j]=(0,t.useState)(null);(0,t.useEffect)((()=>{v&&b()}),[f]);const b=async()=>{try{const e=await(0,c.xt)(Number(f));j(e),m((0,c.od)())}catch(e){console.error(e);const r=(0,$.A)(e);x(r,{variant:"error"}),s(o.nB.customer.root)}};return(0,M.jsx)(u.A,{title:`Customer: ${r(v?"p_customer.edit_customer":"p_customer.new_customer")}`,children:(0,M.jsxs)(a.A,{maxWidth:!e&&"lg",children:[(0,M.jsx)(p.A,{heading:r(v?"p_customer.edit_customer":"p_customer.new_customer"),links:[{name:r("params.dashboard"),href:o.nB.root},{name:r("sideBar.customer"),href:o.nB.customer.root},{name:v?`${r("p_customer.customer")} ${null===_||void 0===_?void 0:_.full_name}`:r("p_customer.new_customer")}]}),(0,M.jsx)(z,{isEdit:v,currentCustomer:_})]})})}},50716:(e,r,s)=>{s.d(r,{A:()=>t});const t=e=>{var r;if(null!==(r=e.response)&&void 0!==r&&r.data){if("string"===typeof e.response.data)return e.response.data;if(Array.isArray(e.response.data))return e.response.data[0];if(e.response.data.detail)return e.response.data.detail}return"An error occurred. Please try again."}}}]);
//# sourceMappingURL=7331.8f4436e8.chunk.js.map